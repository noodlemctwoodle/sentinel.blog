{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workspace": {
            "type": "string",
            "minLength": 1,
            "metadata": {
                "description": "Log Analytics workspace name"
            }
        },
        "workspace-location": {
            "type": "string",
            "minLength": 1,
            "metadata": {
                "description": "Region of the Log Analytics workspace"
            }
        },
        "dataCollectionEndpointName": {
            "type": "string",
            "minLength": 1,
            "metadata": {
                "description": "Name of the Data Collection Endpoint"
            }
        },
        "dataCollectionRuleName": {
            "type": "string",
            "defaultValue": "UniFiSiteManager-ISPMetrics-DCR",
            "metadata": {
                "description": "Name of the Data Collection Rule"
            }
        },
        "tableName": {
            "type": "string",
            "defaultValue": "UniFiSiteManager_ISPMetrics_CL",
            "metadata": {
                "description": "Custom log table name (must end with _CL)"
            }
        },
        "metricInterval": {
            "type": "string",
            "defaultValue": "1h",
            "allowedValues": [
                "5m",
                "1h"
            ],
            "metadata": {
                "description": "ISP metrics aggregation interval (5m or 1h). Note: 5m is Early Access only."
            }
        },
        "pollingIntervalMinutes": {
            "type": "int",
            "defaultValue": 60,
            "minValue": 5,
            "maxValue": 1440,
            "metadata": {
                "description": "How often to poll the UniFi Site Manager API (in minutes). Recommended: 60 for 1h metrics, 5 for 5m metrics."
            }
        }
    },
    "variables": {
        "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
        "dataCollectionEndpointId": "[resourceId('Microsoft.Insights/dataCollectionEndpoints', parameters('dataCollectionEndpointName'))]",
        "streamName": "[concat('Custom-', replace(parameters('tableName'), '_CL', '_Input'))]",
        "outputStream": "[concat('Custom-', parameters('tableName'))]",
        "apiEndpoint": "[concat('https://api.ui.com/ea/isp-metrics/', parameters('metricInterval'))]",
        "_solutionName": "UniFi Site Manager",
        "_solutionVersion": "0.1.0",
        "_solutionAuthor": "Fetch Labs",
        "_solutionId": "azuresentinel.azure-sentinel-solution-unifi-sitemanager-ispmetrics",
        "_solutionTier": "Fetch Labs",
        "dataConnectorVersionConnectorDefinition": "1.0.0",
        "dataConnectorVersionConnections": "1.0.0",
        "_dataConnectorContentIdConnectorDefinition": "UniFiSiteManagerISPMetricsConnectorDefinition",
        "dataConnectorTemplateNameConnectorDefinition": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition')))]",
        "_dataConnectorContentIdConnections": "UniFiSiteManagerISPMetricsConnections",
        "dataConnectorTemplateNameConnections": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections')))]",
        "_connectorUiConfigId": "UniFiSiteManagerISPMetricsConnector",
        "_connectorDataType": "UniFi Site Manager - ISP Metrics"
    },
    "resources": [
        {
            "name": "[concat(parameters('workspace'), '/', parameters('tableName'))]",
            "apiVersion": "2022-10-01",
            "type": "Microsoft.OperationalInsights/workspaces/tables",
            "location": "[parameters('workspace-location')]",
            "properties": {
                "schema": {
                    "name": "[parameters('tableName')]",
                    "columns": [
                        { "name": "TimeGenerated", "type": "datetime", "description": "Event generation time" },
                        { "name": "metricType", "type": "string", "description": "Type of ISP metric (e.g., latency, speed, uptime)" },
                        { "name": "hostId", "type": "string", "description": "Unique identifier of the host reporting metrics" },
                        { "name": "siteId", "type": "string", "description": "Unique identifier of the site" },
                        { "name": "periods", "type": "dynamic", "description": "Array of metric periods containing ISP performance data" }
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition'), variables('dataConnectorVersionConnectorDefinition'))]",
            "location": "[parameters('workspace-location')]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
            ],
            "properties": {
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition')]",
                "displayName": "[concat(variables('_solutionName'), ' - ISP Metrics Connector Definition')]",
                "contentKind": "DataConnector",
                "mainTemplate": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "[variables('dataConnectorVersionConnectorDefinition')]",
                    "parameters": {},
                    "variables": {},
                    "resources": [
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition')))]",
                            "apiVersion": "2022-01-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
                            "properties": {
                                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition'))]",
                                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition')]",
                                "kind": "DataConnector",
                                "version": "[variables('dataConnectorVersionConnectorDefinition')]",
                                "source": {
                                    "sourceId": "[variables('_solutionId')]",
                                    "name": "[variables('_solutionName')]",
                                    "kind": "Solution"
                                },
                                "author": {
                                    "name": "[variables('_solutionAuthor')]"
                                },
                                "support": {
                                    "name": "[variables('_solutionAuthor')]",
                                    "tier": "[variables('_solutionTier')]"
                                },
                                "dependencies": {
                                    "criteria": [
                                        {
                                            "version": "[variables('dataConnectorVersionConnections')]",
                                            "contentId": "[variables('_dataConnectorContentIdConnections')]",
                                            "kind": "ResourcesDataConnector"
                                        }
                                    ]
                                }
                            }
                        },
                        {
                            "name": "[parameters('dataCollectionRuleName')]",
                            "apiVersion": "2021-09-01-preview",
                            "type": "Microsoft.Insights/dataCollectionRules",
                            "location": "[parameters('workspace-location')]",
                            "properties": {
                                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId')]",
                                "streamDeclarations": {
                                    "[variables('streamName')]": {
                                        "columns": [
                                            { "name": "metricType", "type": "string" },
                                            { "name": "hostId", "type": "string" },
                                            { "name": "siteId", "type": "string" },
                                            { "name": "periods", "type": "dynamic" }
                                        ]
                                    }
                                },
                                "destinations": {
                                    "logAnalytics": [
                                        {
                                            "workspaceResourceId": "[variables('workspaceResourceId')]",
                                            "name": "clv2ws1"
                                        }
                                    ]
                                },
                                "dataFlows": [
                                    {
                                        "streams": ["[variables('streamName')]"],
                                        "destinations": ["clv2ws1"],
                                        "transformKql": "source | extend TimeGenerated = now()",
                                        "outputStream": "[variables('outputStream')]"
                                    }
                                ]
                            }
                        }
                    ]
                },
                "packageKind": "Solution",
                "packageVersion": "[variables('_solutionVersion')]",
                "packageName": "[variables('_solutionName')]",
                "contentProductId": "[concat(substring(variables('_solutionId'), 0, 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition'),'-', variables('dataConnectorVersionConnectorDefinition'))))]",
                "packageId": "[variables('_solutionId')]",
                "contentSchemaVersion": "3.0.0",
                "version": "[variables('_solutionVersion')]"
            }
        },
        {
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition'))]",
            "apiVersion": "2022-09-01-preview",
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
            "location": "[parameters('workspace-location')]",
            "kind": "Customizable",
            "properties": {
                "connectorUiConfig": {
                    "id": "[variables('_connectorUiConfigId')]",
                    "title": "UniFi Site Manager - ISP Metrics (via API)",
                    "publisher": "Community",
                    "descriptionMarkdown": "This connector ingests ISP performance metrics from the [UniFi Site Manager API](https://developer.ui.com/site-manager-api/gettingstarted) into Microsoft Sentinel.\n\nISP Metrics provide visibility into your internet connection health across all UniFi sites, enabling you to monitor latency, packet loss, download/upload speeds, and uptime.\n\n**Data Collected:**\n- Latency measurements (average, min, max)\n- Packet loss percentage\n- Download and upload speeds (kbps)\n- Connection uptime percentage\n- ISP provider information\n- WAN interface details\n\n**Metric Intervals:**\n- `1h` - Hourly aggregated metrics (stable API)\n- `5m` - 5-minute granularity (Early Access API)\n\n**API Status:**\n> ⚠️ **Early Access**: The ISP Metrics API (`/ea/isp-metrics`) is in Early Access. The endpoint path and response structure may change.\n\n**Rate Limits:**\n- Early Access: 100 requests per minute\n\n**Prerequisites:**\n1. Sign in to [UniFi Site Manager](https://unifi.ui.com)\n2. Navigate to **API** from the left navigation\n3. Click **Create API Key**\n4. Copy and securely store the generated key (shown only once)",
                    "graphQueriesTableName": "[parameters('tableName')]",
                    "graphQueries": [
                        {
                            "metricName": "Total ISP metrics received",
                            "legend": "UniFi ISP Metrics",
                            "baseQuery": "[parameters('tableName')]"
                        }
                    ],
                    "sampleQueries": [
                        {
                            "description": "All ISP metrics (latest)",
                            "query": "[concat(parameters('tableName'), '\n| sort by TimeGenerated desc\n| take 100')]"
                        },
                        {
                            "description": "Expand and analyze metric periods",
                            "query": "[concat(parameters('tableName'), '\n| mv-expand period = periods\n| extend \n    periodStart = todatetime(period.start),\n    periodEnd = todatetime(period.end),\n    avgLatency = todouble(period.latency.avg),\n    packetLoss = todouble(period.packetLoss),\n    downloadKbps = todouble(period.download),\n    uploadKbps = todouble(period.upload),\n    uptime = todouble(period.uptime)\n| project TimeGenerated, hostId, siteId, periodStart, avgLatency, packetLoss, downloadKbps, uploadKbps, uptime\n| sort by periodStart desc')]"
                        },
                        {
                            "description": "High latency events (>100ms)",
                            "query": "[concat(parameters('tableName'), '\n| mv-expand period = periods\n| extend avgLatency = todouble(period.latency.avg)\n| where avgLatency > 100\n| project TimeGenerated, hostId, siteId, avgLatency\n| sort by avgLatency desc')]"
                        },
                        {
                            "description": "Packet loss events",
                            "query": "[concat(parameters('tableName'), '\n| mv-expand period = periods\n| extend packetLoss = todouble(period.packetLoss)\n| where packetLoss > 0\n| project TimeGenerated, hostId, siteId, packetLoss\n| sort by packetLoss desc')]"
                        },
                        {
                            "description": "Average metrics by site",
                            "query": "[concat(parameters('tableName'), '\n| mv-expand period = periods\n| extend \n    avgLatency = todouble(period.latency.avg),\n    downloadKbps = todouble(period.download),\n    uploadKbps = todouble(period.upload)\n| summarize \n    AvgLatency = avg(avgLatency),\n    AvgDownloadMbps = avg(downloadKbps) / 1000,\n    AvgUploadMbps = avg(uploadKbps) / 1000\n    by siteId\n| sort by AvgLatency desc')]"
                        },
                        {
                            "description": "Uptime summary by host",
                            "query": "[concat(parameters('tableName'), '\n| mv-expand period = periods\n| extend uptime = todouble(period.uptime)\n| summarize AvgUptime = avg(uptime), MinUptime = min(uptime) by hostId\n| sort by AvgUptime asc')]"
                        },
                        {
                            "description": "Speed test trends over time",
                            "query": "[concat(parameters('tableName'), '\n| mv-expand period = periods\n| extend \n    periodStart = todatetime(period.start),\n    downloadMbps = todouble(period.download) / 1000,\n    uploadMbps = todouble(period.upload) / 1000\n| summarize AvgDownload = avg(downloadMbps), AvgUpload = avg(uploadMbps) by bin(periodStart, 1h)\n| sort by periodStart asc')]"
                        }
                    ],
                    "dataTypes": [
                        {
                            "name": "[parameters('tableName')]",
                            "lastDataReceivedQuery": "[concat(parameters('tableName'), '\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)')]"
                        }
                    ],
                    "connectivityCriteria": [
                        {
                            "type": "HasDataConnectors"
                        }
                    ],
                    "availability": {
                        "status": 1,
                        "isPreview": true
                    },
                    "permissions": {
                        "resourceProvider": [
                            {
                                "provider": "Microsoft.OperationalInsights/workspaces",
                                "permissionsDisplayText": "Read and Write permissions required",
                                "providerDisplayName": "Workspace",
                                "scope": "Workspace",
                                "requiredPermissions": {
                                    "read": true,
                                    "write": true,
                                    "delete": true
                                }
                            }
                        ],
                        "customs": [
                            {
                                "name": "UniFi Site Manager API Key",
                                "description": "A read-only API key from [unifi.ui.com](https://unifi.ui.com) with access to your UniFi deployment. The API key is tied to your UI account and provides access to ISP metrics for all sites you own or have super admin permissions for."
                            }
                        ]
                    },
                    "instructionSteps": [
                        {
                            "title": "1. Obtain a UniFi Site Manager API Key",
                            "description": "To connect to the UniFi Site Manager API, you need an API key:\n\n1. Sign in to [UniFi Site Manager](https://unifi.ui.com)\n2. Click **API** in the left navigation bar\n3. Click **Create API Key**\n4. Copy the generated key immediately - it will only be displayed once\n\n> **Note:** The API key is currently read-only and provides access to all sites associated with your UI account."
                        },
                        {
                            "title": "2. Understand ISP Metrics Data",
                            "description": "ISP Metrics are returned as time-series data in the `periods` array. Each period contains:\n\n| Field | Description |\n|-------|-------------|\n| `start` / `end` | Period timestamps |\n| `latency.avg` | Average latency in milliseconds |\n| `packetLoss` | Packet loss percentage |\n| `download` | Download speed in kbps |\n| `upload` | Upload speed in kbps |\n| `uptime` | Connection uptime percentage |\n\nUse `mv-expand periods` in KQL to flatten the time-series data for analysis."
                        },
                        {
                            "title": "3. Connect to UniFi Site Manager",
                            "description": "Enter your API key below to start ingesting ISP metrics into Microsoft Sentinel.",
                            "instructions": [
                                {
                                    "type": "Textbox",
                                    "parameters": {
                                        "label": "UniFi Site Manager API Key",
                                        "placeholder": "Enter your API key from unifi.ui.com",
                                        "type": "password",
                                        "name": "apiKey"
                                    }
                                },
                                {
                                    "type": "ConnectionToggleButton",
                                    "parameters": {
                                        "connectLabel": "Connect",
                                        "disconnectLabel": "Disconnect"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition')))]",
            "apiVersion": "2022-01-01-preview",
            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
            "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersionConnectorDefinition')]",
                "source": {
                    "sourceId": "[variables('_solutionId')]",
                    "name": "[variables('_solutionName')]",
                    "kind": "Solution"
                },
                "author": {
                    "name": "[variables('_solutionAuthor')]"
                },
                "support": {
                    "name": "[variables('_solutionAuthor')]",
                    "tier": "[variables('_solutionTier')]"
                },
                "dependencies": {
                    "criteria": [
                        {
                            "version": "[variables('dataConnectorVersionConnections')]",
                            "contentId": "[variables('_dataConnectorContentIdConnections')]",
                            "kind": "ResourcesDataConnector"
                        }
                    ]
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections'), variables('dataConnectorVersionConnections'))]",
            "location": "[parameters('workspace-location')]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
            ],
            "properties": {
                "contentId": "[variables('_dataConnectorContentIdConnections')]",
                "displayName": "[concat(variables('_solutionName'), ' - ISP Metrics Connections')]",
                "contentKind": "ResourcesDataConnector",
                "mainTemplate": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "[variables('dataConnectorVersionConnections')]",
                    "parameters": {
                        "connectorDefinitionName": {
                            "defaultValue": "connectorDefinitionName",
                            "type": "string",
                            "minLength": 1
                        },
                        "workspace": {
                            "defaultValue": "[parameters('workspace')]",
                            "type": "string"
                        },
                        "dcrConfig": {
                            "defaultValue": {
                                "dataCollectionEndpoint": "data collection Endpoint",
                                "dataCollectionRuleImmutableId": "data collection rule immutableId"
                            },
                            "type": "object"
                        },
                        "apiKey": {
                            "defaultValue": "",
                            "type": "securestring",
                            "minLength": 1
                        }
                    },
                    "variables": {
                        "_dataConnectorContentIdConnections": "[variables('_dataConnectorContentIdConnections')]"
                    },
                    "resources": [
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections')))]",
                            "apiVersion": "2022-01-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
                            "properties": {
                                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections'))]",
                                "contentId": "[variables('_dataConnectorContentIdConnections')]",
                                "kind": "ResourcesDataConnector",
                                "version": "[variables('dataConnectorVersionConnections')]",
                                "source": {
                                    "sourceId": "[variables('_solutionId')]",
                                    "name": "[variables('_solutionName')]",
                                    "kind": "Solution"
                                },
                                "author": {
                                    "name": "[variables('_solutionAuthor')]"
                                },
                                "support": {
                                    "name": "[variables('_solutionAuthor')]",
                                    "tier": "[variables('_solutionTier')]"
                                }
                            }
                        },
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'UniFiSiteManagerISPMetricsPoller')]",
                            "apiVersion": "2022-12-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
                            "location": "[parameters('workspace-location')]",
                            "kind": "RestApiPoller",
                            "properties": {
                                "connectorDefinitionName": "[[parameters('connectorDefinitionName')]",
                                "dataType": "[variables('_connectorDataType')]",
                                "dcrConfig": {
                                    "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                                    "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]",
                                    "streamName": "[variables('streamName')]"
                                },
                                "auth": {
                                    "type": "APIKey",
                                    "ApiKey": "[[parameters('apiKey')]",
                                    "ApiKeyName": "X-API-Key",
                                    "ApiKeyIdentifier": ""
                                },
                                "request": {
                                    "apiEndpoint": "[variables('apiEndpoint')]",
                                    "httpMethod": "GET",
                                    "queryParameters": {
                                        "pageSize": "200"
                                    },
                                    "headers": {
                                        "Accept": "application/json"
                                    },
                                    "rateLimitQPS": 1,
                                    "queryWindowInMin": "[parameters('pollingIntervalMinutes')]",
                                    "retryCount": 3,
                                    "timeoutInSeconds": 120
                                },
                                "response": {
                                    "eventsJsonPaths": ["$.data[*]"],
                                    "format": "json"
                                },
                                "paging": {
                                    "pagingType": "NextPageToken",
                                    "nextPageTokenJsonPath": "$.nextToken",
                                    "nextPageParaName": "nextToken"
                                },
                                "isActive": true
                            }
                        }
                    ]
                },
                "packageKind": "Solution",
                "packageVersion": "[variables('_solutionVersion')]",
                "packageName": "[variables('_solutionName')]",
                "contentProductId": "[concat(substring(variables('_solutionId'), 0, 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections'),'-', variables('dataConnectorVersionConnections'))))]",
                "packageId": "[variables('_solutionId')]",
                "contentSchemaVersion": "3.0.0",
                "version": "[variables('_solutionVersion')]"
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]",
            "location": "[parameters('workspace-location')]",
            "apiVersion": "2023-04-01-preview",
            "properties": {
                "version": "[variables('_solutionVersion')]",
                "kind": "Solution",
                "contentSchemaVersion": "3.0.0",
                "contentId": "[variables('_solutionId')]",
                "source": {
                    "kind": "Solution",
                    "name": "[variables('_solutionName')]",
                    "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                    "name": "[variables('_solutionAuthor')]"
                },
                "support": {
                    "name": "[variables('_solutionAuthor')]"
                },
                "dependencies": {
                    "operator": "AND",
                    "criteria": [
                        {
                            "kind": "DataConnector",
                            "contentId": "[variables('dataConnectorVersionConnectorDefinition')]",
                            "version": "[variables('_dataConnectorContentIdConnectorDefinition')]"
                        }
                    ]
                },
                "firstPublishDate": "2025-01-01",
                "providers": ["[variables('_solutionAuthor')]"],
                "contentKind": "Solution",
                "packageId": "[variables('_solutionId')]",
                "contentProductId": "[concat(substring(variables('_solutionId'), 0, 50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]",
                "displayName": "[variables('_solutionName')]",
                "publisherDisplayName": "[concat(variables('_solutionAuthor'), ' (', variables('_solutionId'), ')')]",
                "descriptionHtml": "The UniFi Site Manager ISP Metrics solution for Microsoft Sentinel provides visibility into your internet connection health by ingesting ISP performance data from the official UniFi Site Manager API (api.ui.com). Monitor latency, packet loss, bandwidth, and uptime across all your UniFi deployments to detect connectivity issues and track ISP performance over time."
            }
        }
    ]
}